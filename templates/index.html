<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rwd{% block title %}{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    typography: {
                        DEFAULT: {
                            css: {
                                maxWidth: '100%',
                            }
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body class="bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 transition-colors duration-300">
    <header class="border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950">
        <div class="max-w-7xl mx-auto px-4 py-8 sm:py-12 md:py-16">
            <div class="mb-8 md:mb-10">
                <h1 id="title-container"
                    class="text-3xl sm:text-4xl md:text-5xl font-light tracking-tight mb-2 inline-block h-14 sm:h-16 md:h-20 flex items-center">
                    <a href="/" class="cursor-pointer hover:text-slate-700 dark:hover:text-slate-300 transition-colors">
                        <span id="full-text"
                            class="max-w-0 inline-block transition-all duration-500 ease-out overflow-hidden whitespace-nowrap opacity-0">rust&nbsp;with&nbsp;data</span><span
                            id="short-text"
                            class="inline-block transition-opacity duration-300 ease-out opacity-100">rwd</span>
                    </a>
                </h1>

            </div>
        </div>
    </header>
    <div class="max-w-7xl mx-auto px-4 py-8 md:py-12 flex flex-col md:flex-row gap-8">
        <main class="flex-grow min-w-0">
            {% block content %}
            <section>
                <h2 class="text-2xl md:text-3xl font-light tracking-tight mb-8 md:mb-10">Latest Posts</h2>

                {% if posts.is_empty() %}
                <div class="text-center py-12 md:py-16">
                    <p class="text-lg text-slate-500 dark:text-slate-400 font-light">No posts found.</p>
                </div>
                {% else %}
                <div class="space-y-6 md:space-y-8">
                    {% for post in posts %}
                    <article
                        class="group border-b border-slate-200 dark:border-slate-800 pb-6 md:pb-8 hover:bg-slate-50 dark:hover:bg-slate-900/50 -mx-4 px-4 py-6 md:-mx-6 md:px-6 transition-colors">
                        <h3 class="text-xl sm:text-2xl font-light tracking-tight mb-3">
                            <a href="/posts/{{ post.markdown.slug }}"
                                class="hover:text-slate-600 dark:hover:text-slate-300 transition-colors">
                                {{ post.markdown.title }}
                            </a>
                        </h3>

                        <div class="flex flex-wrap gap-4 text-sm text-slate-600 dark:text-slate-400">
                            <span class="font-light">{{ post.markdown.date }}</span>

                            {% if post.markdown.tags.len() > 0 %}
                            <div class="flex gap-2 flex-wrap">
                                {% for tag in post.markdown.tags %}
                                <span
                                    class="px-2 py-1 text-xs bg-slate-100 dark:bg-slate-800 rounded text-slate-700 dark:text-slate-300 font-medium">{{
                                    tag }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}

                            {% match post.markdown.series %}
                            {% when Some(series) %}
                            <span class="italic text-slate-500 dark:text-slate-500">{{ series.title }} — Ep. {{
                                series.ep }}</span>
                            {% when None %}
                            {% endmatch %}
                        </div>
                    </article>
                    {% endfor %}
                </div>
                {% endif %}
            </section>
            {% endblock %}
        </main>
        <aside class="w-full md:w-64 flex-shrink-0">
            <div class="sticky top-8 space-y-3">
                <div class="relative">
                    <input type="text" id="search-input" placeholder="Search posts..."
                        class="w-full px-4 py-2.5 text-sm bg-slate-50 dark:bg-slate-900 border border-slate-300 dark:border-slate-700 rounded transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 dark:focus:ring-slate-600">
                    <svg class="absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400 dark:text-slate-600 pointer-events-none"
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
                <div class="space-y-2">
                    <div class="relative group w-full">
                        <button
                            class="w-full px-3 py-2.5 text-sm font-medium border border-slate-300 dark:border-slate-700 rounded bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors text-left">
                            Tags
                        </button>
                        <div
                            class="absolute left-0 mt-1 w-56 bg-white dark:bg-slate-900 rounded border border-slate-200 dark:border-slate-800 shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 max-h-96 overflow-y-auto">
                            {% for (tag, count) in tags_with_count %}
                            <a href="/posts/by-tag?tag={{ tag }}"
                                class="block px-4 py-2 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors border-b border-slate-100 dark:border-slate-800 last:border-b-0">
                                <span class="font-medium">{{ tag }}</span> <span
                                    class="text-slate-500 dark:text-slate-500 text-xs">({{ count }})</span>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="relative group w-full">
                        <button
                            class="w-full px-3 py-2.5 text-sm font-medium border border-slate-300 dark:border-slate-700 rounded bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors text-left">
                            Archive
                        </button>
                        <div
                            class="absolute left-0 mt-1 w-64 bg-white dark:bg-slate-900 rounded border border-slate-200 dark:border-slate-800 shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 max-h-96 overflow-y-auto">
                            {% for (year, months) in dates_by_year %}
                            <div class="border-b border-slate-200 dark:border-slate-800 last:border-b-0">
                                <div
                                    class="px-4 py-2 bg-slate-100 dark:bg-slate-800 font-semibold text-slate-900 dark:text-slate-100 text-xs sticky top-0">
                                    {{ year }}
                                </div>
                                {% for (month_name, month_num, count) in months %}
                                <a href="/posts/by-date?year={{ year }}&month={{ month_num }}"
                                    class="block px-6 py-2 text-sm text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                                    {{ month_name }} <span class="text-slate-500 dark:text-slate-500 text-xs">({{ count
                                        }})</span>
                                </a>
                                {% endfor %}
                                <a href="/posts/by-date?year={{ year }}"
                                    class="block px-6 py-2 text-sm font-medium text-slate-900 dark:text-slate-100 bg-slate-50 dark:bg-slate-800 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                                    All of {{ year }}
                                </a>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                </div>
            </div>
        </aside>
    </div>
    <footer class="border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 mt-12 md:mt-16">
        <div class="max-w-7xl mx-auto px-4 py-10 md:py-14">
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center mb-8 md:mb-10">
                <a href="https://linkedin.com/in/rafaldraws" target="_blank" rel="noopener noreferrer"
                    class="flex items-center justify-center gap-2 px-4 py-2.5 border border-slate-300 dark:border-slate-700 rounded hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors text-sm font-medium">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                    </svg>
                    <span class="hidden sm:inline">LinkedIn</span>
                </a>

                <a href="https://github.com/softwarecowboy" target="_blank" rel="noopener noreferrer"
                    class="flex items-center justify-center gap-2 px-4 py-2.5 border border-slate-300 dark:border-slate-700 rounded hover:bg-slate-50 dark:hover:bg-slate-900 transition-colors text-sm font-medium">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                    </svg>
                    <span class="hidden sm:inline">GitHub</span>
                </a>

                <button id="theme-toggle"
                    class="inline-flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium border border-slate-300 dark:border-slate-700 rounded bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                    <svg id="sun-icon" class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="5" />
                        <path
                            d="M12 1v6M12 17v6M4.22 4.22l4.24 4.24M15.54 15.54l4.24 4.24M1 12h6M17 12h6M4.22 19.78l4.24-4.24M15.54 8.46l4.24-4.24"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            fill="none" />
                    </svg>
                    <svg id="moon-icon" class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                    </svg>
                    <span id="theme-label">Light</span>
                </button>
            </div>
            <div class="text-center pt-6 md:pt-8 border-t border-slate-200 dark:border-slate-800">
                <p class="text-sm text-slate-600 dark:text-slate-400 font-light mb-4">&copy; 2026 Rafał Waldemar Draws
                </p>

            </div>
        </div>
    </footer>
    <script>
        const titleContainer = document.getElementById('title-container');
        const fullText = document.getElementById('full-text');
        const shortText = document.getElementById('short-text');
        let hoverTimeout;

        titleContainer.addEventListener('mouseenter', () => {
            clearTimeout(hoverTimeout);
            fullText.style.maxWidth = '100%';
            setTimeout(() => {
                shortText.style.opacity = '0';
                shortText.style.pointerEvents = 'none';
            }, 0);
            fullText.style.opacity = '1';
        });

        titleContainer.addEventListener('mouseleave', () => {
            hoverTimeout = setTimeout(() => {
                fullText.style.opacity = '0';
                shortText.style.opacity = '1';
                shortText.style.pointerEvents = 'auto';
                fullText.style.maxWidth = '0';
            }, 200);
        });

        fullText.style.maxWidth = '0';
        fullText.style.opacity = '0';
        shortText.style.opacity = '1';
    </script>

    <script>
        function initTheme() {
            const isDark = localStorage.getItem('theme') === 'dark' ||
                (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);

            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function updateThemeLabel() {
            const isDark = document.documentElement.classList.contains('dark');
            const label = document.getElementById('theme-label');
            if (label) {
                label.textContent = isDark ? 'Dark' : 'Light';
            }
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark');
            if (isDark) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
            }
            updateThemeLabel();
        }

        initTheme();
        updateThemeLabel();

        const themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', toggleTheme);
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
            if (!localStorage.getItem('theme')) {
                initTheme();
                updateThemeLabel();
            }
        });
    </script>

    <script>
        const searchInput = document.getElementById('search-input');
        if (searchInput) {
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const keyword = searchInput.value.trim();
                    if (keyword) {
                        window.location.href = `/posts/by-keyword?keyword=${encodeURIComponent(keyword)}`;
                    }
                }
            });
        }
    </script>

</body>

</html>